# ç³»ç»Ÿæ¶æ„è®¾è®¡

## 1. æ¶æ„æ¦‚è§ˆ

```text
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   Web Client    â”‚
                            â”‚   (Next.js)     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚ HTTPS / WebSocket
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         API Gateway (Vercel Edge)                   â”‚
â”‚                    è®¤è¯ / é™æµ / è·¯ç”± / WebSocket                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚                            â”‚
        â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent API    â”‚          â”‚   Session API   â”‚          â”‚   Admin API     â”‚
â”‚  (Node.js)    â”‚          â”‚   (Node.js)     â”‚          â”‚   (Node.js)     â”‚
â”‚  Serverless   â”‚          â”‚   Serverless    â”‚          â”‚   Serverless    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ Redis Stream
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    Agent Runtime      â”‚
        â”‚    (Python Worker)    â”‚
        â”‚                       â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  Orchestrator   â”‚  â”‚
        â”‚  â”‚  (çŠ¶æ€å›¾ç¼–æ’)    â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚           â”‚           â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚                 â”‚  â”‚
        â”‚  â–¼                 â–¼  â”‚
        â”‚ â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”â”‚
        â”‚ â”‚Sub â”‚  â”‚Sub â”‚ â”‚Sub â”‚â”‚
        â”‚ â”‚Agt1â”‚  â”‚Agt2â”‚ â”‚Agt3â”‚â”‚
        â”‚ â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚               â”‚               â”‚
    â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redis  â”‚    â”‚PostgreSQLâ”‚    â”‚ LLM APIs â”‚
â”‚ Queue  â”‚    â”‚+ pgvectorâ”‚    â”‚(å¤šæ¨¡å‹)   â”‚
â”‚ Cache  â”‚    â”‚          â”‚    â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2. åˆ†å±‚è®¾è®¡

### 2.1 è¡¨ç°å±‚ (Presentation Layer)

**èŒè´£**: ç”¨æˆ·äº¤äº’ã€çŠ¶æ€å±•ç¤º

- **æŠ€æœ¯**: Next.js 14 App Router
- **éƒ¨ç½²**: Vercel Edge
- **åŠŸèƒ½**:
  - Agent ç®¡ç†ç•Œé¢
  - Skill é…ç½®ç•Œé¢
  - å¯¹è¯äº¤äº’ç•Œé¢
  - å®æ—¶çŠ¶æ€å±•ç¤º (SSE/WebSocket)

#### 2.1.1 ä¸‰æ å¸ƒå±€è®¾è®¡

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                      Header (é¡¶éƒ¨å¯¼èˆª)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Logo â”‚  æœç´¢æ                                                    ç”¨æˆ·å¤´åƒ | è®¾ç½®   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 â”‚                                    â”‚                                   â”‚
â”‚  NavBar         â”‚         Sidebar (ä¼šè¯åŒº)            â”‚     Detail Canvas (è¯¦æƒ…ç”»å¸ƒ)      â”‚
â”‚  (å¯¼èˆª + ä¼šè¯)   â”‚                                    â”‚                                   â”‚
â”‚                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚      æ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ–           â”‚  â”‚  â”‚                             â”‚  â”‚
â”‚ â”‚ ğŸ  é¦–é¡µ     â”‚ â”‚  â”‚                              â”‚  â”‚  â”‚      ç»“æœæ•°æ®å±•ç¤ºåŒº          â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚                             â”‚  â”‚
â”‚ â”‚ ğŸ¤– Agents   â”‚ â”‚  â”‚  â”‚ PLAN â”‚â–¶â”‚ ACT  â”‚â–¶â”‚OBSERVEâ”‚ â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚  â”‚  âœ“   â”‚ â”‚  â—‰   â”‚ â”‚  â—‹   â”‚ â”‚  â”‚  â”‚  â”‚   ğŸ“Š æ•°æ®è¡¨æ ¼        â”‚   â”‚  â”‚
â”‚ â”‚ âš™ï¸ è®¾ç½®     â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  â”‚                     â”‚   â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚   Col1 | Col2 | Col3â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚  ğŸ”§ web_search â”€â”€ âœ“ 1.2s    â”‚  â”‚  â”‚  â”‚   â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”‚   â”‚  â”‚
â”‚ â”‚ â”€â”€ ä¼šè¯ â”€â”€  â”‚ â”‚  â”‚  ğŸ”§ code_exec  â”€â”€ â—‰ è¿è¡Œä¸­  â”‚  â”‚  â”‚  â”‚   val  | val | val â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚                                    â”‚  â”‚                             â”‚  â”‚
â”‚ â”‚ â”‚+ æ–°ä¼šè¯ â”‚ â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚  â”‚      ğŸ’­ æ€è€ƒè¿‡ç¨‹              â”‚  â”‚  â”‚  â”‚   ğŸ“ˆ å›¾è¡¨           â”‚   â”‚  â”‚
â”‚ â”‚ â”‚ğŸ“ ä¼šè¯1 â”‚ â”‚ â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚      â•±â•²             â”‚   â”‚  â”‚
â”‚ â”‚ â”‚ 14:30   â”‚ â”‚ â”‚  â”‚  æ­£åœ¨åˆ†æç”¨æˆ·éœ€æ±‚...         â”‚  â”‚  â”‚  â”‚    â•±    â•²           â”‚   â”‚  â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚  â”‚  > è¯†åˆ«å…³é”®ä¿¡æ¯              â”‚  â”‚  â”‚  â”‚  â•±        â•²__â•±      â”‚   â”‚  â”‚
â”‚ â”‚ â”‚ğŸ“ ä¼šè¯2 â”‚ â”‚ â”‚  â”‚  > åˆ¶å®šæ‰§è¡Œè®¡åˆ’              â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ â”‚ â”‚ 10:15   â”‚ â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                             â”‚  â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚                                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”‚ â”‚ğŸ“ ä¼šè¯3 â”‚ â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚   ğŸ“„ æŠ¥å‘Š           â”‚   â”‚  â”‚
â”‚ â”‚ â”‚ æ˜¨å¤©    â”‚ â”‚ â”‚  â”‚      ğŸ’¬ å¯¹è¯åŒº               â”‚  â”‚  â”‚  â”‚                     â”‚   â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚   ## åˆ†æç»“è®º       â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚  ğŸ‘¤: å¸®æˆ‘åˆ†æé”€å”®æ•°æ®        â”‚  â”‚  â”‚  â”‚   æ ¹æ®æ•°æ®åˆ†æ...   â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚  ğŸ¤–: å¥½çš„ï¼Œæˆ‘æ¥åˆ†æ...       â”‚  â”‚  â”‚  â”‚                     â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚                              â”‚  â”‚  â”‚  â”‚   ### å»ºè®®          â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚  â”‚  â”‚   1. ...            â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚  â”‚ è¾“å…¥æ¶ˆæ¯...        â”‚ å‘é€ â”‚  â”‚  â”‚  â”‚   2. ...            â”‚   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ â”‚             â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                             â”‚  â”‚
â”‚ â”‚             â”‚ â”‚                                    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚ â”‚   [æŠ˜å  â—€]  â”‚ â”‚                                    â”‚  â”‚  â”‚æŠ˜å  â”‚ â”‚å±•å¼€ â”‚ â”‚å…¨å± â”‚   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚                 â”‚                                    â”‚  â”‚                             â”‚  â”‚
â”‚ 60px â†” 240px    â”‚              flex: 1               â”‚  â”‚      320px â†” 100%           â”‚  â”‚
â”‚   å¯æŠ˜å /å±•å¼€    â”‚                                    â”‚  â”‚   å¯æŠ˜å /å±•å¼€/æœ€å¤§åŒ–         â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸‰æ èŒè´£åˆ’åˆ†**ï¼š

| åŒºåŸŸ | å®½åº¦ | çŠ¶æ€ | èŒè´£ | ç»„ä»¶ |
| ---- | ---- | ---- | ---- | ---- |
| **NavBar (å¯¼èˆªæ )** | 60px â†” 240px | å¯æŠ˜å /å±•å¼€ | ä¸»å¯¼èˆªå…¥å£ + **ä¼šè¯åˆ—è¡¨** | `NavBar.tsx` |
| **Sidebar (ä¼šè¯åŒº)** | flex: 1 è‡ªé€‚åº” | å§‹ç»ˆæ˜¾ç¤º | æ‰§è¡Œè¿‡ç¨‹ã€æ€è€ƒè¿‡ç¨‹ã€**å¯¹è¯äº¤äº’** | `SessionView.tsx` |
| **Detail Canvas (è¯¦æƒ…ç”»å¸ƒ)** | 320px â†” 100% | å¯æŠ˜å /å±•å¼€/æœ€å¤§åŒ– | **ç»“æœæ•°æ®ã€æŠ¥å‘Šå±•ç¤º** | `DetailCanvas.tsx` |

#### 2.1.2 å¸ƒå±€çŠ¶æ€åˆ‡æ¢

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å¸ƒå±€çŠ¶æ€ç¤ºæ„                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  ã€çŠ¶æ€ 1: æ ‡å‡†æ¨¡å¼ã€‘                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚NavBarâ”‚        Sidebar             â”‚  Detail Canvas  â”‚                       â”‚
â”‚  â”‚å±•å¼€   â”‚        ä¼šè¯æ‰§è¡Œ             â”‚    ç»“æœå±•ç¤º      â”‚                       â”‚
â”‚  â”‚240px â”‚        flex: 1             â”‚     320px       â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                 â”‚
â”‚  ã€çŠ¶æ€ 2: å¯¼èˆªæŠ˜å ã€‘ NavBar æ”¶èµ·ä¸ºå›¾æ ‡æ                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚Nav â”‚          Sidebar             â”‚  Detail Canvas  â”‚                       â”‚
â”‚  â”‚60pxâ”‚          flex: 1             â”‚     320px       â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                 â”‚
â”‚  ã€çŠ¶æ€ 3: è¯¦æƒ…æŠ˜å ã€‘ æ— ç»“æœæ•°æ®æ—¶è‡ªåŠ¨æŠ˜å ï¼Œä¼šè¯åŒºæœ€å¤§åŒ–                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚NavBarâ”‚              Sidebar                   â”‚ â–¶ â”‚ â† æŠ˜å æŒ‰é’®              â”‚
â”‚  â”‚å±•å¼€   â”‚              flex: 1                   â”‚    â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                                 â”‚
â”‚  ã€çŠ¶æ€ 4: è¯¦æƒ…æœ€å¤§åŒ–ã€‘ å…¨å±å±•ç¤ºæŠ¥å‘Š/æ•°æ®                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ â—€ â”‚              Detail Canvas (100%)               â”‚                       â”‚
â”‚  â”‚    â”‚                                                â”‚                       â”‚
â”‚  â”‚    â”‚         ğŸ“„ å®Œæ•´æŠ¥å‘Š / ğŸ“Š å¤§å±æ•°æ®å¯è§†åŒ–         â”‚                       â”‚
â”‚  â”‚    â”‚                                                â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**çŠ¶æ€ç®¡ç†**ï¼š

```typescript
// stores/layoutStore.ts
interface LayoutState {
  navBarExpanded: boolean      // å¯¼èˆªæ å±•å¼€çŠ¶æ€
  detailCanvasMode: 'collapsed' | 'normal' | 'maximized'  // è¯¦æƒ…ç”»å¸ƒæ¨¡å¼
  hasDetailContent: boolean    // æ˜¯å¦æœ‰è¯¦æƒ…å†…å®¹ï¼ˆæ§åˆ¶è‡ªåŠ¨æŠ˜å ï¼‰
}

// çŠ¶æ€è½¬æ¢
const layoutActions = {
  toggleNavBar: () => void       // åˆ‡æ¢å¯¼èˆªæ æŠ˜å 
  collapseDetail: () => void     // æŠ˜å è¯¦æƒ…ç”»å¸ƒ
  expandDetail: () => void       // å±•å¼€è¯¦æƒ…ç”»å¸ƒ
  maximizeDetail: () => void     // æœ€å¤§åŒ–è¯¦æƒ…ç”»å¸ƒ
  exitMaximize: () => void       // é€€å‡ºæœ€å¤§åŒ–
}
```

#### 2.1.3 Agent2UI æ¸²æŸ“è§„èŒƒ

éµå¾ª **Agent2UI** è®¾è®¡ç†å¿µï¼šåç«¯åªä¼ è¾“ç»“æ„åŒ– JSON æ•°æ®ï¼Œå‰ç«¯ç»„ä»¶è´Ÿè´£æ™ºèƒ½æ¸²æŸ“ã€‚

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Agent2UI æ¶æ„                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Backend (API/Runtime)              Frontend (React Components)            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚                 â”‚   SSE/JSON     â”‚                         â”‚            â”‚
â”‚   â”‚  Agent Runtime  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   ComponentRegistry     â”‚            â”‚
â”‚   â”‚                 â”‚                â”‚                         â”‚            â”‚
â”‚   â”‚  åªè¾“å‡º JSON:   â”‚                â”‚   æ ¹æ® type è‡ªåŠ¨è·¯ç”±:    â”‚            â”‚
â”‚   â”‚  {              â”‚                â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚   â”‚    type: "...", â”‚                â”‚   â”‚ type â†’ Component  â”‚ â”‚            â”‚
â”‚   â”‚    data: {...}  â”‚                â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚            â”‚
â”‚   â”‚  }              â”‚                â”‚   â”‚ text â†’ TextBlock  â”‚ â”‚            â”‚
â”‚   â”‚                 â”‚                â”‚   â”‚ table â†’ DataTable â”‚ â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚ chart â†’ Chart     â”‚ â”‚            â”‚
â”‚                                      â”‚   â”‚ code â†’ CodeBlock  â”‚ â”‚            â”‚
â”‚                                      â”‚   â”‚ image â†’ ImageView â”‚ â”‚            â”‚
â”‚                                      â”‚   â”‚ plan â†’ PlanView   â”‚ â”‚            â”‚
â”‚                                      â”‚   â”‚ tool â†’ ToolResult â”‚ â”‚            â”‚
â”‚                                      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒ JSON æ•°æ®ç±»å‹å®šä¹‰**ï¼š

```typescript
// Agent2UI æ¶ˆæ¯ç±»å‹
interface Agent2UIMessage {
  id: string
  type: Agent2UIType
  data: Agent2UIData
  timestamp: string
  metadata?: Record<string, unknown>
}

type Agent2UIType =
  | 'text'           // çº¯æ–‡æœ¬
  | 'markdown'       // Markdown å¯Œæ–‡æœ¬
  | 'code'           // ä»£ç å—
  | 'table'          // æ•°æ®è¡¨æ ¼
  | 'chart'          // å›¾è¡¨ (ECharts/Recharts)
  | 'image'          // å›¾ç‰‡
  | 'file'           // æ–‡ä»¶ä¸‹è½½
  | 'plan'           // æ‰§è¡Œè®¡åˆ’
  | 'progress'       // è¿›åº¦æŒ‡ç¤º
  | 'tool_call'      // å·¥å…·è°ƒç”¨
  | 'tool_result'    // å·¥å…·ç»“æœ
  | 'error'          // é”™è¯¯ä¿¡æ¯
  | 'thinking'       // æ€è€ƒè¿‡ç¨‹
  | 'report'         // ç»“æ„åŒ–æŠ¥å‘Š

// å„ç±»å‹æ•°æ®ç»“æ„
interface TextData {
  content: string
}

interface TableData {
  columns: { key: string; title: string; type?: 'string' | 'number' | 'date' }[]
  rows: Record<string, unknown>[]
  pagination?: { page: number; pageSize: number; total: number }
}

interface ChartData {
  chartType: 'line' | 'bar' | 'pie' | 'scatter' | 'area'
  title?: string
  xAxis?: { data: string[] }
  yAxis?: { name: string }
  series: { name: string; data: number[] }[]
}

interface PlanData {
  steps: {
    id: string
    title: string
    status: 'pending' | 'running' | 'completed' | 'failed'
    substeps?: { id: string; title: string; status: string }[]
  }[]
  currentStep: string
}

interface ToolCallData {
  toolName: string
  arguments: Record<string, unknown>
  status: 'calling' | 'success' | 'error'
  result?: unknown
  duration?: number
}

interface ReportData {
  title: string
  sections: {
    heading: string
    content: Agent2UIMessage[]  // åµŒå¥—æ”¯æŒ
  }[]
  summary?: string
}
```

#### 2.1.4 ç»„ä»¶æ³¨å†Œä¸æ¸²æŸ“

```typescript
// components/agent2ui/ComponentRegistry.tsx
import { TextBlock } from './TextBlock'
import { MarkdownBlock } from './MarkdownBlock'
import { CodeBlock } from './CodeBlock'
import { DataTable } from './DataTable'
import { Chart } from './Chart'
import { PlanView } from './PlanView'
import { ToolCallView } from './ToolCallView'
import { ReportView } from './ReportView'
import { ThinkingView } from './ThinkingView'
import { ProgressView } from './ProgressView'

const componentMap: Record<Agent2UIType, React.ComponentType<any>> = {
  text: TextBlock,
  markdown: MarkdownBlock,
  code: CodeBlock,
  table: DataTable,
  chart: Chart,
  image: ImageView,
  file: FileDownload,
  plan: PlanView,
  progress: ProgressView,
  tool_call: ToolCallView,
  tool_result: ToolResultView,
  error: ErrorView,
  thinking: ThinkingView,
  report: ReportView,
}

export function Agent2UIRenderer({ message }: { message: Agent2UIMessage }) {
  const Component = componentMap[message.type]

  if (!Component) {
    console.warn(`Unknown Agent2UI type: ${message.type}`)
    return <TextBlock data={{ content: JSON.stringify(message.data) }} />
  }

  return <Component data={message.data} metadata={message.metadata} />
}
```

#### 2.1.5 Sidebar å¸ƒå±€åŒºåŸŸ (ä¼šè¯åŒº)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Sidebar (ä¼šè¯åŒº)                                 â”‚
â”‚                         èŒè´£: æ‰§è¡Œè¿‡ç¨‹ + å¯¹è¯äº¤äº’                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Process Area (æ‰§è¡Œè¿‡ç¨‹åŒº)                        â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚                   Plan View (è®¡åˆ’è§†å›¾)                       â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”          â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   â”‚Step1â”‚â”€â”€â–¶â”‚Step2â”‚â”€â”€â–¶â”‚Step3â”‚â”€â”€â–¶â”‚Step4â”‚â”€â”€â–¶â”‚Step5â”‚          â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   â”‚ âœ“   â”‚   â”‚ âœ“   â”‚   â”‚ â—‰   â”‚   â”‚ â—‹   â”‚   â”‚ â—‹   â”‚          â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜          â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚               Tool Calls (å·¥å…·è°ƒç”¨è¿½è¸ª)                      â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   ğŸ”§ web_search("AI news")  â”€â”€  âœ“ 1.2s                      â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   ğŸ”§ code_executor(...)     â”€â”€  â—‰ running...                â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚               Thinking View (æ€è€ƒè¿‡ç¨‹)                       â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   ğŸ’­ æ­£åœ¨åˆ†æç”¨æˆ·éœ€æ±‚...                                     â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   > è¯†åˆ«å…³é”®ä¿¡æ¯                                             â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   > åˆ¶å®šæ‰§è¡Œè®¡åˆ’                                             â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Chat Area (å¯¹è¯äº¤äº’åŒº)                           â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚  Message List (æ¶ˆæ¯æµ)                             flex: 1  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚ ğŸ‘¤ User: å¸®æˆ‘åˆ†æè¿™ä»½é”€å”®æ•°æ®                         â”‚   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚ ğŸ¤– Agent: å¥½çš„ï¼Œæˆ‘æ¥åˆ†æè¿™ä»½æ•°æ®...                   â”‚   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚                                                     â”‚   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚ [ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š â†’]  â† ç‚¹å‡»ååœ¨ Detail Canvas å±•ç¤º   â”‚   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚   â”‚ è¾“å…¥æ‚¨çš„é—®é¢˜...                                 â”‚  â”‚  å‘é€   â”‚  â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.1.6 Detail Canvas å¸ƒå±€åŒºåŸŸ (è¯¦æƒ…ç”»å¸ƒ)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Detail Canvas (è¯¦æƒ…ç”»å¸ƒ)                             â”‚
â”‚                    èŒè´£: ç»“æœæ•°æ® + æŠ¥å‘Šå±•ç¤º                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Header                                                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“Š é”€å”®æ•°æ®åˆ†ææŠ¥å‘Š              â”‚    â”‚ â—€  â”‚ â”‚ â–¢  â”‚ â”‚ â›¶  â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ ç”Ÿæˆæ—¶é—´: 2026-02-05 12:30       â”‚    â”‚æŠ˜å  â”‚ â”‚å±•å¼€ â”‚ â”‚å…¨å± â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Content Area (å†…å®¹åŒº)                   flex: 1 â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚                   ğŸ“Š Data Table (æ•°æ®è¡¨æ ¼)                   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚  äº§å“    â”‚  Q1é”€é‡   â”‚  Q2é”€é‡  â”‚  Q3é”€é‡   â”‚  å¢é•¿ç‡   â”‚  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚ äº§å“A    â”‚  1,200   â”‚  1,450   â”‚  1,680   â”‚  +40%    â”‚  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚ äº§å“B    â”‚  800     â”‚  920     â”‚  1,100   â”‚  +38%    â”‚  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â”‚ äº§å“C    â”‚  650     â”‚  580     â”‚  520     â”‚  -20%    â”‚  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚                                       [å¯¼å‡º CSV] [å¯¼å‡º Excel] â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚                   ğŸ“ˆ Chart (å›¾è¡¨å¯è§†åŒ–)                      â”‚   â”‚  â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚   â”‚         â–²                                                   â”‚   â”‚  â”‚
â”‚  â”‚   â”‚    1800 â”‚                                    â•±â”€â”€â— äº§å“A     â”‚   â”‚  â”‚
â”‚  â”‚   â”‚    1500 â”‚                      â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±               â”‚   â”‚  â”‚
â”‚  â”‚   â”‚    1200 â”‚       â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±                  â•±â”€â”€ äº§å“B  â”‚   â”‚  â”‚
â”‚  â”‚   â”‚     900 â”‚      â•±                    â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•±           â”‚   â”‚  â”‚
â”‚  â”‚   â”‚     600 â”‚â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—                         â”‚   â”‚  â”‚
â”‚  â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                â”‚   â”‚  â”‚
â”‚  â”‚   â”‚              Q1         Q2         Q3                       â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚   â”‚                   ğŸ“„ Report (åˆ†ææŠ¥å‘Š)                       â”‚   â”‚  â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   ## åˆ†æç»“è®º                                                â”‚   â”‚  â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   æ ¹æ® Q1-Q3 é”€å”®æ•°æ®åˆ†æï¼Œä¸»è¦å‘ç°å¦‚ä¸‹ï¼š                      â”‚   â”‚  â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   ### 1. å¢é•¿è¶‹åŠ¿                                            â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   - äº§å“A å’Œ äº§å“B å‘ˆç°æŒç»­å¢é•¿æ€åŠ¿                           â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   - äº§å“C éœ€è¦å…³æ³¨ï¼Œè¿ç»­ä¸‰ä¸ªå­£åº¦ä¸‹æ»‘                          â”‚   â”‚  â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   ### 2. å»ºè®®æªæ–½                                            â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   1. åŠ å¤§äº§å“Açš„å¸‚åœºæŠ•å…¥                                      â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   2. åˆ†æäº§å“Cä¸‹æ»‘åŸå› ï¼Œè€ƒè™‘äº§å“å‡çº§æˆ–æ·˜æ±°                     â”‚   â”‚  â”‚
â”‚  â”‚   â”‚   3. äº§å“Bå¯è€ƒè™‘æ‰©å±•åˆ°æ–°å¸‚åœº                                  â”‚   â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Footer                                                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ [ğŸ“¥ ä¸‹è½½æŠ¥å‘Š]  [ğŸ“¤ åˆ†äº«]  [ğŸ–¨ï¸ æ‰“å°]  [ğŸ“‹ å¤åˆ¶åˆ°å‰ªè´´æ¿]         â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Detail Canvas çŠ¶æ€è¯´æ˜**ï¼š

| çŠ¶æ€ | è§¦å‘æ¡ä»¶ | è¡Œä¸º |
| ---- | -------- | ---- |
| **æŠ˜å ** | æ— ç»“æœæ•°æ®æ—¶è‡ªåŠ¨è§¦å‘ / ç”¨æˆ·ç‚¹å‡»æŠ˜å  | éšè—å†…å®¹åŒºï¼Œä»…æ˜¾ç¤ºå±•å¼€æŒ‰é’® |
| **å±•å¼€** | æœ‰ç»“æœæ•°æ®æ—¶é»˜è®¤ / ç”¨æˆ·ç‚¹å‡»å±•å¼€ | æ­£å¸¸æ˜¾ç¤ºï¼Œå®½åº¦ 320px |
| **æœ€å¤§åŒ–** | ç”¨æˆ·ç‚¹å‡»å…¨å±æŒ‰é’® | è¦†ç›–æ•´ä¸ªè§†å£ï¼Œéšè— NavBar å’Œ Sidebar |

**æ”¯æŒçš„å†…å®¹ç±»å‹**ï¼š

| ç±»å‹ | ç»„ä»¶ | è¯´æ˜ |
| ---- | ---- | ---- |
| `table` | `DataTable` | æ”¯æŒæ’åºã€ç­›é€‰ã€åˆ†é¡µã€å¯¼å‡º |
| `chart` | `Chart` | æ”¯æŒ line/bar/pie/scatter/area |
| `report` | `ReportView` | Markdown æ ¼å¼çš„ç»“æ„åŒ–æŠ¥å‘Š |
| `image` | `ImageView` | å›¾ç‰‡å±•ç¤ºï¼Œæ”¯æŒç¼©æ”¾ |
| `file` | `FileDownload` | æ–‡ä»¶ä¸‹è½½é“¾æ¥ |
| `code` | `CodeBlock` | ä»£ç é«˜äº®å±•ç¤º |

#### 2.1.7 å‰ç«¯ç›®å½•ç»“æ„

```text
apps/web/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (auth)/                     # è®¤è¯é¡µé¢ç»„
â”‚   â”œâ”€â”€ (dashboard)/                # ä¸»åº”ç”¨é¡µé¢ç»„
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # ä¸‰æ å¸ƒå±€å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â””â”€â”€ [sessionId]/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx        # ä¼šè¯è¯¦æƒ…é¡µ
â”‚   â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â””â”€â”€ api/                        # API Routes
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ layout/                     # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AppShell.tsx            # åº”ç”¨å¤–å£³ (ä¸‰æ å®¹å™¨)
â”‚   â”‚   â”œâ”€â”€ NavBar.tsx              # å·¦ä¾§å¯¼èˆªæ  (60px)
â”‚   â”‚   â”œâ”€â”€ SessionSidebar.tsx      # ä¼šè¯ä¾§è¾¹æ  (280px)
â”‚   â”‚   â””â”€â”€ DetailCanvas.tsx        # è¯¦æƒ…ç”»å¸ƒ (flex)
â”‚   â”‚
â”‚   â”œâ”€â”€ agent2ui/                   # Agent2UI ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ index.ts                # ç»Ÿä¸€å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ ComponentRegistry.tsx   # ç»„ä»¶æ³¨å†Œä¸­å¿ƒ
â”‚   â”‚   â”œâ”€â”€ Agent2UIRenderer.tsx    # ç»Ÿä¸€æ¸²æŸ“å™¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ text/                   # æ–‡æœ¬ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ TextBlock.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MarkdownBlock.tsx
â”‚   â”‚   â”‚   â””â”€â”€ CodeBlock.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ data/                   # æ•°æ®ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ DataTable.tsx       # è¡¨æ ¼ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Chart.tsx           # å›¾è¡¨ç»„ä»¶ (ECharts)
â”‚   â”‚   â”‚   â””â”€â”€ ImageView.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ process/                # è¿‡ç¨‹ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ PlanView.tsx        # è®¡åˆ’æ­¥éª¤è§†å›¾
â”‚   â”‚   â”‚   â”œâ”€â”€ ProgressView.tsx    # è¿›åº¦æ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ ThinkingView.tsx    # æ€è€ƒè¿‡ç¨‹å±•ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolCallView.tsx    # å·¥å…·è°ƒç”¨å¡ç‰‡
â”‚   â”‚   â”‚   â””â”€â”€ ToolResultView.tsx  # å·¥å…·ç»“æœå±•ç¤º
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ report/                 # æŠ¥å‘Šç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ ReportView.tsx      # ç»“æ„åŒ–æŠ¥å‘Š
â”‚   â”‚   â”‚   â””â”€â”€ SummaryCard.tsx     # æ‘˜è¦å¡ç‰‡
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ feedback/               # åé¦ˆç±»
â”‚   â”‚       â”œâ”€â”€ ErrorView.tsx
â”‚   â”‚       â””â”€â”€ LoadingView.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ chat/                       # å¯¹è¯ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatContainer.tsx       # å¯¹è¯å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ MessageList.tsx         # æ¶ˆæ¯åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ MessageItem.tsx         # å•æ¡æ¶ˆæ¯
â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx           # è¾“å…¥æ¡†
â”‚   â”‚   â””â”€â”€ StreamingText.tsx       # æµå¼æ–‡æœ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ session/                    # ä¼šè¯ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SessionList.tsx         # ä¼šè¯åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ SessionCard.tsx         # ä¼šè¯å¡ç‰‡
â”‚   â”‚   â””â”€â”€ SessionSearch.tsx       # ä¼šè¯æœç´¢
â”‚   â”‚
â”‚   â””â”€â”€ ui/                         # åŸºç¡€ UI ç»„ä»¶
â”‚       â”œâ”€â”€ Button.tsx
â”‚       â”œâ”€â”€ Input.tsx
â”‚       â”œâ”€â”€ Card.tsx
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useSSE.ts                   # SSE è¿æ¥ Hook
â”‚   â”œâ”€â”€ useAgent2UI.ts              # Agent2UI æ¶ˆæ¯å¤„ç†
â”‚   â”œâ”€â”€ useSession.ts               # ä¼šè¯çŠ¶æ€
â”‚   â””â”€â”€ useChat.ts                  # å¯¹è¯äº¤äº’
â”‚
â”œâ”€â”€ stores/                         # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ sessionStore.ts             # ä¼šè¯çŠ¶æ€
â”‚   â”œâ”€â”€ chatStore.ts                # å¯¹è¯çŠ¶æ€
â”‚   â””â”€â”€ uiStore.ts                  # UI çŠ¶æ€ (ä¾§è¾¹æ æŠ˜å ç­‰)
â”‚
â””â”€â”€ types/
    â””â”€â”€ agent2ui.ts                 # Agent2UI ç±»å‹å®šä¹‰
```

#### 2.1.8 SSE å®æ—¶æ•°æ®æµ

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     POST /chat      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Redis Stream     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚             â”‚
â”‚   Browser   â”‚                     â”‚  API Layer  â”‚                      â”‚   Runtime   â”‚
â”‚             â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚             â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚             â”‚
â”‚             â”‚     SSE Stream      â”‚             â”‚     Redis Pub/Sub    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                                                        â”‚
       â”‚  EventSource                                                          â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
       â”‚  â”‚ event: message                                                 â”‚   â”‚
       â”‚  â”‚ data: {"type":"thinking","data":{"content":"åˆ†æé—®é¢˜..."}}      â”‚â—€â”€â”€â”¤
       â”‚  â”‚                                                                â”‚   â”‚
       â”‚  â”‚ event: message                                                 â”‚   â”‚
       â”‚  â”‚ data: {"type":"plan","data":{"steps":[...],"currentStep":"1"}} â”‚â—€â”€â”€â”¤
       â”‚  â”‚                                                                â”‚   â”‚
       â”‚  â”‚ event: message                                                 â”‚   â”‚
       â”‚  â”‚ data: {"type":"tool_call","data":{"toolName":"web_search"}}    â”‚â—€â”€â”€â”¤
       â”‚  â”‚                                                                â”‚   â”‚
       â”‚  â”‚ event: message                                                 â”‚   â”‚
       â”‚  â”‚ data: {"type":"table","data":{"columns":[...],"rows":[...]}}   â”‚â—€â”€â”€â”˜
       â”‚  â”‚                                                                â”‚
       â”‚  â”‚ event: done                                                    â”‚
       â”‚  â”‚ data: {"sessionId":"...","messageId":"..."}                    â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
  Agent2UIRenderer åŠ¨æ€æ¸²æŸ“å„ç±»å‹ç»„ä»¶
```

### 2.2 API å±‚ (API Layer)

**èŒè´£**: è¯·æ±‚è·¯ç”±ã€è®¤è¯æˆæƒã€æ•°æ®æ ¡éªŒ

- **æŠ€æœ¯**: Vercel Serverless Functions (Node.js)
- **éƒ¨ç½²**: Vercel
- **åŠŸèƒ½**:
  - RESTful API ç«¯ç‚¹
  - WebSocket ç½‘å…³
  - è¯·æ±‚è®¤è¯ä¸é™æµ
  - ä»»åŠ¡åˆ†å‘åˆ°é˜Ÿåˆ—

### 2.3 æ‰§è¡Œå±‚ (Execution Layer)

**èŒè´£**: Agent é€»è¾‘æ‰§è¡Œã€ç¼–æ’è°ƒåº¦

- **æŠ€æœ¯**: Python + LangChain/LangGraph
- **éƒ¨ç½²**: Modal / Fly.io (Serverless Container)
- **åŠŸèƒ½**:
  - Agent çŠ¶æ€æœºæ‰§è¡Œ
  - SubAgent ç¼–æ’
  - Skill/Tool è°ƒç”¨
  - LLM äº¤äº’

### 2.4 æ•°æ®å±‚ (Data Layer)

**èŒè´£**: æ•°æ®æŒä¹…åŒ–ã€ç¼“å­˜ã€é˜Ÿåˆ—

| ç»„ä»¶ | ç”¨é€” | æœåŠ¡ |
| ---- | ---- | ---- |
| PostgreSQL | ä¸»æ•°æ®å­˜å‚¨ | Supabase / Neon |
| pgvector | å‘é‡å­˜å‚¨(é•¿æœŸè®°å¿†) | Supabase |
| Redis | ä»»åŠ¡é˜Ÿåˆ—ã€ç¼“å­˜ã€ä¼šè¯çŠ¶æ€ | Upstash |

## 3. é€šä¿¡æ¨¡å¼

### 3.1 åŒæ­¥è¯·æ±‚-å“åº”

```text
Client -> API -> Database -> API -> Client
```

é€‚ç”¨äº: Agent CRUDã€Session ç®¡ç†ã€é…ç½®æŸ¥è¯¢

### 3.2 å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—

```text
Client -> API -> Redis Queue -> Worker -> Redis -> API -> Client
```

é€‚ç”¨äº: Agent æ‰§è¡Œï¼ˆå¯èƒ½è€—æ—¶è¾ƒé•¿ï¼‰

### 3.3 æµå¼å“åº” (SSE)

```text
Client <-- SSE <-- API <-- Redis Pub/Sub <-- Worker
```

é€‚ç”¨äº: å®æ—¶å¯¹è¯è¾“å‡º

## 3.4 ç«¯åˆ°ç«¯æ ¸å¿ƒæµç¨‹ï¼ˆæ—¶åºï¼‰

```mermaid
sequenceDiagram
    participant U as User/Client
    participant GW as API Gateway
    participant API as API Layer
    participant DB as PostgreSQL
    participant Q as Redis Queue
    participant RT as Agent Runtime
    participant LLM as LLM Provider

    U->>GW: è¯·æ±‚æ‰§è¡Œ Agent
    GW->>API: é‰´æƒé€šè¿‡/è·¯ç”±
    API->>DB: åˆ›å»º session + message
    API->>Q: æŠ•é€’ä»»åŠ¡
    API-->>U: è¿”å› session_id (å¯é€‰ SSE)

    RT->>Q: æ‹‰å–ä»»åŠ¡
    RT->>DB: åŠ è½½ Agent/Session
    RT->>LLM: è§„åˆ’/æ‰§è¡Œ
    RT->>DB: å†™æ¶ˆæ¯/æ—¥å¿—/ä½¿ç”¨é‡
    RT-->>API: ç»“æœ/æµå¼è¾“å‡º
    API-->>U: å“åº”æˆ–æµå¼æ¨é€
```

## 4. æ ¸å¿ƒç»„ä»¶

### 4.1 Agent Orchestrator

çŠ¶æ€å›¾ç¼–æ’å™¨ï¼Œæ§åˆ¶ Agent æ‰§è¡Œæµç¨‹ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  START  â”‚â”€â”€â”€â”€â–¶â”‚  THINK  â”‚â”€â”€â”€â”€â–¶â”‚  ACT    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                     â”‚               â”‚
                     â–¼               â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ DELEGATEâ”‚     â”‚ RESPOND â”‚
                â”‚(SubAgent)â”‚    â”‚         â”‚
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                     â”‚               â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   END   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Skill Registry

æŠ€èƒ½æ³¨å†Œä¸­å¿ƒï¼Œç®¡ç†æ‰€æœ‰å¯ç”¨æŠ€èƒ½ï¼š

```text
SkillRegistry
â”œâ”€â”€ web_search      # ç½‘é¡µæœç´¢
â”œâ”€â”€ browser_control # æµè§ˆå™¨æ§åˆ¶ï¼ˆå¯¼èˆªã€å¿«ç…§ã€äº¤äº’ï¼‰
â”œâ”€â”€ code_executor   # ä»£ç æ‰§è¡Œ
â”œâ”€â”€ data_query      # æ•°æ®æŸ¥è¯¢
â”œâ”€â”€ file_manager    # æ–‡ä»¶ç®¡ç†
â””â”€â”€ custom_skills   # ç”¨æˆ·è‡ªå®šä¹‰æŠ€èƒ½
```

### 4.3 Memory System

åˆ†å±‚è®°å¿†ç³»ç»Ÿï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Memory System             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Short-term  â”‚  â”‚  Long-term   â”‚  â”‚
â”‚  â”‚  (Redis)    â”‚  â”‚  (pgvector)  â”‚  â”‚
â”‚  â”‚             â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ - å½“å‰å¯¹è¯   â”‚  â”‚ - å†å²æ€»ç»“   â”‚  â”‚
â”‚  â”‚ - å·¥å…·ç»“æœ   â”‚  â”‚ - ç”¨æˆ·åå¥½   â”‚  â”‚
â”‚  â”‚ - ä¸´æ—¶çŠ¶æ€   â”‚  â”‚ - çŸ¥è¯†åº“     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 å¤šç§Ÿæˆ·ä¸æƒé™éš”ç¦»

- **ç»„ç»‡çº§éš”ç¦»**: æ‰€æœ‰æ ¸å¿ƒèµ„æºï¼ˆAgentsã€Sessionsã€Logsã€Usageï¼‰å¿…é¡»ç»‘å®š `org_id`ã€‚
- **é‰´æƒç­–ç•¥**: API Key/JWT å‡æ˜ å°„åˆ° `org_id` + `user_id`ï¼Œå¹¶åŸºäºæƒé™å£°æ˜è¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚
- **è®¿é—®è¾¹ç•Œ**: API å±‚è¿‡æ»¤ `org_id`ï¼ŒRuntime ä»…å¤„ç†åŒç»„ç»‡çš„ä»»åŠ¡ã€‚

### 4.5 å¯è§‚æµ‹æ€§

- **ç»“æ„åŒ–æ—¥å¿—**: execution_logs è®°å½•çŠ¶æ€æµè½¬ä¸å·¥å…·è°ƒç”¨ã€‚
- **æŒ‡æ ‡**: QPSã€å¹³å‡å“åº”æ—¶é—´ã€å¤±è´¥ç‡ã€æ¨¡å‹/å·¥å…·è°ƒç”¨è€—æ—¶ã€‚
- **è¿½è¸ª**: session_id ä½œä¸ºå…¨é“¾è·¯ trace_idã€‚

### 4.6 å¯é æ€§ä¸å®¹é”™

- **ä»»åŠ¡å¹‚ç­‰**: ä½¿ç”¨ session_id + step_id åšå¹‚ç­‰ä¿æŠ¤ã€‚
- **è¶…æ—¶ä¸é‡è¯•**: LLM/Tool è°ƒç”¨å…·å¤‡æŒ‡æ•°é€€é¿ä¸æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚
- **é™çº§**: æ— æ³•æ‰§è¡Œæ—¶è¿”å›å»ºè®®ä¸å¯æ¢å¤æ“ä½œã€‚

### 4.7 å¤šæ¨¡å‹é€‚é…å±‚

ç»Ÿä¸€çš„ LLM Provider æ¥å£ï¼Œæ”¯æŒå¤šç§æ¨¡å‹æ— ç¼åˆ‡æ¢ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     LLM Provider Layer                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚  LLM Router     â”‚                          â”‚
â”‚                    â”‚  (æ¨¡å‹è·¯ç”±)      â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â–¼              â–¼         â–¼              â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  OpenAI    â”‚ â”‚ Anthropic  â”‚ â”‚   Google   â”‚ â”‚   Local    â”‚   â”‚
â”‚  â”‚  Provider  â”‚ â”‚  Provider  â”‚ â”‚  Provider  â”‚ â”‚  Provider  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ GPT-4o     â”‚ â”‚ Claude 3.5 â”‚ â”‚ Gemini Pro â”‚ â”‚ Ollama     â”‚   â”‚
â”‚  â”‚ GPT-4o-miniâ”‚ â”‚ Claude 3   â”‚ â”‚ Gemini 2.0 â”‚ â”‚ vLLM       â”‚   â”‚
â”‚  â”‚ o1-preview â”‚ â”‚ Haiku      â”‚ â”‚            â”‚ â”‚ LocalAI    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
- **ç»Ÿä¸€æ¥å£**ï¼šæ‰€æœ‰æ¨¡å‹å…±ç”¨ `LLMProvider` æŠ½è±¡æ¥å£
- **è‡ªåŠ¨é™çº§**ï¼šä¸»æ¨¡å‹å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ° `fallback_model`
- **æ™ºèƒ½è·¯ç”±**ï¼šæ ¹æ®ä»»åŠ¡ç±»å‹ï¼ˆæ¨ç†/ç”Ÿæˆ/ç®€å•é—®ç­”ï¼‰é€‰æ‹©æœ€ä¼˜æ¨¡å‹
- **æˆæœ¬ä¼˜åŒ–**ï¼šç®€å•ä»»åŠ¡ä½¿ç”¨ä½æˆæœ¬æ¨¡å‹ï¼Œå¤æ‚ä»»åŠ¡ä½¿ç”¨é«˜èƒ½åŠ›æ¨¡å‹

### 4.8 MCP (Model Context Protocol) é›†æˆ

å…¼å®¹ Claude MCP åè®®ï¼Œæ”¯æŒæ ‡å‡†åŒ–å·¥å…·é›†æˆï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       MCP Integration                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  MCP Manager    â”‚  ç®¡ç†æ‰€æœ‰ MCP Server è¿æ¥                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚        â–¼                                            â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚        â”‚
â”‚  â”‚  â”‚ MCP Serverâ”‚  â”‚ MCP Serverâ”‚  â”‚ MCP Serverâ”‚       â”‚        â”‚
â”‚  â”‚  â”‚  (stdio)  â”‚  â”‚   (SSE)   â”‚  â”‚(WebSocket)â”‚       â”‚        â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚        â”‚
â”‚  â”‚  â”‚ filesystemâ”‚  â”‚  browser  â”‚  â”‚  database â”‚       â”‚        â”‚
â”‚  â”‚  â”‚   tools   â”‚  â”‚   tools   â”‚  â”‚   tools   â”‚       â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ”¯æŒçš„ä¼ è¾“æ–¹å¼**ï¼š
- **stdio**ï¼šæ ‡å‡†è¾“å…¥è¾“å‡ºï¼Œé€‚ç”¨äºæœ¬åœ°è¿›ç¨‹
- **SSE**ï¼šæœåŠ¡å™¨æ¨é€äº‹ä»¶ï¼Œé€‚ç”¨äºè¿œç¨‹æœåŠ¡
- **WebSocket**ï¼šåŒå‘é€šä¿¡ï¼Œé€‚ç”¨äºå®æ—¶äº¤äº’

### 4.9 å›½é™…åŒ– (i18n)

å¤šè¯­è¨€æ”¯æŒæ¶æ„ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       i18n Layer                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚ Language Router â”‚  Accept-Language â†’ locale                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                 Translation Resources                 â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚
â”‚  â”‚  â”‚  zh-CN  â”‚  â”‚  en-US  â”‚  â”‚  ja-JP  â”‚  â”‚  ko-KR  â”‚ â”‚       â”‚
â”‚  â”‚  â”‚ ç®€ä½“ä¸­æ–‡ â”‚  â”‚ English â”‚  â”‚  æ—¥æœ¬èª  â”‚  â”‚  í•œêµ­ì–´  â”‚ â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                  â”‚
â”‚  åº”ç”¨èŒƒå›´ï¼š                                                       â”‚
â”‚  - API é”™è¯¯æ¶ˆæ¯                                                   â”‚
â”‚  - å‰ç«¯ UI æ–‡æœ¬                                                   â”‚
â”‚  - Agent ç³»ç»Ÿæç¤ºè¯æ¨¡æ¿                                           â”‚
â”‚  - é‚®ä»¶é€šçŸ¥å†…å®¹                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. ä»£ç ç›®å½•ç»“æ„

```text
semibot/
â”œâ”€â”€ apps/                           # åº”ç”¨å±‚
â”‚   â”œâ”€â”€ web/                        # å‰ç«¯åº”ç”¨ (Next.js 14)
â”‚   â”‚   â”œâ”€â”€ app/                    # App Router é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ (auth)/             # è®¤è¯ç›¸å…³é¡µé¢ç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚   â”‚   â”œâ”€â”€ (dashboard)/        # ä»ªè¡¨ç›˜é¡µé¢ç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ agents/         # Agent ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sessions/       # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ settings/       # è®¾ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/               # å¯¹è¯ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ api/                # API Routes (BFF)
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ components/             # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                 # åŸºç¡€ UI ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/               # å¯¹è¯ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ agents/             # Agent ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ common/             # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ lib/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ stores/                 # çŠ¶æ€ç®¡ç† (Zustand)
â”‚   â”‚   â”œâ”€â”€ styles/                 # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ types/                  # TypeScript ç±»å‹
â”‚   â”‚   â””â”€â”€ i18n/                   # å›½é™…åŒ–èµ„æº
â”‚   â”‚       â”œâ”€â”€ locales/
â”‚   â”‚       â”‚   â”œâ”€â”€ zh-CN.json
â”‚   â”‚       â”‚   â”œâ”€â”€ en-US.json
â”‚   â”‚       â”‚   â””â”€â”€ ja-JP.json
â”‚   â”‚       â””â”€â”€ config.ts
â”‚   â”‚
â”‚   â””â”€â”€ api/                        # API æœåŠ¡ (Node.js Serverless)
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ routes/             # API è·¯ç”±
â”‚       â”‚   â”‚   â”œâ”€â”€ v1/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ agents.ts
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ sessions.ts
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ chat.ts
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ skills.ts
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ admin.ts
â”‚       â”‚   â”‚   â””â”€â”€ index.ts
â”‚       â”‚   â”œâ”€â”€ middleware/         # ä¸­é—´ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ rateLimit.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ validate.ts
â”‚       â”‚   â”‚   â””â”€â”€ errorHandler.ts
â”‚       â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚       â”‚   â”‚   â”œâ”€â”€ agent.service.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ session.service.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ chat.service.ts
â”‚       â”‚   â”‚   â””â”€â”€ queue.service.ts
â”‚       â”‚   â”œâ”€â”€ repositories/       # æ•°æ®è®¿é—®å±‚
â”‚       â”‚   â”‚   â”œâ”€â”€ agent.repository.ts
â”‚       â”‚   â”‚   â”œâ”€â”€ session.repository.ts
â”‚       â”‚   â”‚   â””â”€â”€ message.repository.ts
â”‚       â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ types/              # TypeScript ç±»å‹
â”‚       â”‚   â””â”€â”€ constants/          # å¸¸é‡å®šä¹‰
â”‚       â”‚       â””â”€â”€ config.ts
â”‚       â”œâ”€â”€ tests/                  # API æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ unit/
â”‚       â”‚   â”œâ”€â”€ integration/
â”‚       â”‚   â””â”€â”€ helpers/
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ runtime/                        # Python Agent Runtime
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ orchestrator/           # çŠ¶æ€æœºç¼–æ’
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ graph.py            # LangGraph çŠ¶æ€å›¾
â”‚   â”‚   â”‚   â”œâ”€â”€ nodes.py            # çŠ¶æ€èŠ‚ç‚¹å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ edges.py            # è¾¹/è·¯ç”±é€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ state.py            # çŠ¶æ€ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ agents/                 # Agent å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py             # åŸºç¡€ Agent ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ planner.py          # è§„åˆ’ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ executor.py         # æ‰§è¡Œ Agent
â”‚   â”‚   â”‚   â””â”€â”€ sub_agents/         # SubAgent å®ç°
â”‚   â”‚   â”œâ”€â”€ skills/                 # æŠ€èƒ½/å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ registry.py         # æŠ€èƒ½æ³¨å†Œä¸­å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ web_search.py
â”‚   â”‚   â”‚   â”œâ”€â”€ code_executor.py
â”‚   â”‚   â”‚   â””â”€â”€ mcp/                # MCP é›†æˆ
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚       â”œâ”€â”€ manager.py
â”‚   â”‚   â”‚       â””â”€â”€ transports/
â”‚   â”‚   â”œâ”€â”€ llm/                    # LLM æä¾›å•†
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py             # æŠ½è±¡æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ router.py           # æ¨¡å‹è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ openai.py
â”‚   â”‚   â”‚   â”œâ”€â”€ anthropic.py
â”‚   â”‚   â”‚   â”œâ”€â”€ google.py
â”‚   â”‚   â”‚   â””â”€â”€ local.py
â”‚   â”‚   â”œâ”€â”€ memory/                 # è®°å¿†ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ short_term.py       # Redis çŸ­æœŸè®°å¿†
â”‚   â”‚   â”‚   â””â”€â”€ long_term.py        # pgvector é•¿æœŸè®°å¿†
â”‚   â”‚   â”œâ”€â”€ queue/                  # ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ consumer.py
â”‚   â”‚   â”‚   â””â”€â”€ producer.py
â”‚   â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ logging.py
â”‚   â”‚       â””â”€â”€ metrics.py
â”‚   â”œâ”€â”€ tests/                      # Python æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â””â”€â”€ fixtures/
â”‚   â”‚       â””â”€â”€ replays/            # æ‰§è¡Œå›æ”¾æ•°æ®
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ requirements-dev.txt
â”‚   â””â”€â”€ pytest.ini
â”‚
â”œâ”€â”€ packages/                       # å…±äº«åŒ… (Monorepo)
â”‚   â”œâ”€â”€ shared-types/               # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ agent.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ session.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ message.ts
â”‚   â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ ui/                         # å…±äº« UI ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ utils/                      # å…±äº«å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ src/
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ database/                       # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ migrations/                 # æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”œâ”€â”€ 001_init_schema.sql
â”‚   â”‚   â”œâ”€â”€ 002_add_skills.sql
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ seeds/                      # ç§å­æ•°æ®
â”‚   â”‚   â”œâ”€â”€ dev/
â”‚   â”‚   â””â”€â”€ test/
â”‚   â””â”€â”€ scripts/                    # æ•°æ®åº“è„šæœ¬
â”‚       â”œâ”€â”€ backup.sh
â”‚       â””â”€â”€ restore.sh
â”‚
â”œâ”€â”€ infra/                          # åŸºç¡€è®¾æ–½é…ç½®
â”‚   â”œâ”€â”€ docker/                     # Docker é…ç½®
â”‚   â”‚   â”œâ”€â”€ Dockerfile.api
â”‚   â”‚   â”œâ”€â”€ Dockerfile.runtime
â”‚   â”‚   â””â”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ k8s/                        # Kubernetes é…ç½® (å¯é€‰)
â”‚   â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”‚   â””â”€â”€ service.yaml
â”‚   â””â”€â”€ terraform/                  # IaC é…ç½® (å¯é€‰)
â”‚       â”œâ”€â”€ main.tf
â”‚       â””â”€â”€ variables.tf
â”‚
â”œâ”€â”€ scripts/                        # å¼€å‘/éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ dev-setup.sh                # å¼€å‘ç¯å¢ƒåˆå§‹åŒ–
â”‚   â”œâ”€â”€ build.sh                    # æ„å»ºè„šæœ¬
â”‚   â””â”€â”€ deploy.sh                   # éƒ¨ç½²è„šæœ¬
â”‚
â”œâ”€â”€ tests/                          # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ e2e/                        # Playwright E2E æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ chat-flow.spec.ts
â”‚   â”‚   â”œâ”€â”€ agent-crud.spec.ts
â”‚   â”‚   â””â”€â”€ auth.spec.ts
â”‚   â”œâ”€â”€ performance/                # æ€§èƒ½æµ‹è¯•
â”‚   â”‚   â””â”€â”€ chat-load.js            # k6 è´Ÿè½½æµ‹è¯•
â”‚   â””â”€â”€ playwright.config.ts
â”‚
â”œâ”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ design/                     # è®¾è®¡æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ ARCHITECTURE.md
â”‚   â”‚   â”œâ”€â”€ API_DESIGN.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ sql/                        # SQL è„šæœ¬æ–‡æ¡£
â”‚
â”œâ”€â”€ .github/                        # GitHub é…ç½®
â”‚   â”œâ”€â”€ workflows/                  # GitHub Actions
â”‚   â”‚   â”œâ”€â”€ test.yml
â”‚   â”‚   â”œâ”€â”€ deploy.yml
â”‚   â”‚   â””â”€â”€ release.yml
â”‚   â””â”€â”€ CODEOWNERS
â”‚
â”œâ”€â”€ .claude/                        # Claude é…ç½®
â”‚   â””â”€â”€ rules/                      # é¡¹ç›®è§„åˆ™
â”‚
â”œâ”€â”€ package.json                    # æ ¹ package.json (pnpm workspace)
â”œâ”€â”€ pnpm-workspace.yaml             # pnpm å·¥ä½œåŒºé…ç½®
â”œâ”€â”€ turbo.json                      # Turborepo é…ç½®
â”œâ”€â”€ tsconfig.json                   # TypeScript é…ç½®
â”œâ”€â”€ vitest.config.ts                # Vitest é…ç½®
â”œâ”€â”€ .env.example                    # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore
â”œâ”€â”€ CLAUDE.md                       # Claude AI æŒ‡å—
â””â”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
```

### 5.1 ç›®å½•è®¾è®¡åŸåˆ™

| åŸåˆ™ | è¯´æ˜ |
| ---- | ---- |
| **Monorepo æ¶æ„** | ä½¿ç”¨ pnpm workspace + Turborepo ç®¡ç†å¤šä¸ªåŒ… |
| **å…³æ³¨ç‚¹åˆ†ç¦»** | apps/ å­˜æ”¾åº”ç”¨ï¼Œpackages/ å­˜æ”¾å…±äº«ä»£ç ï¼Œruntime/ ç‹¬ç«‹ Python è¿è¡Œæ—¶ |
| **æŒ‰åŠŸèƒ½ç»„ç»‡** | æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ç›®å½•ï¼Œé«˜å†…èšä½è€¦åˆ |
| **æµ‹è¯•å°±è¿‘åŸåˆ™** | å•å…ƒ/é›†æˆæµ‹è¯•ä¸ä»£ç åŒç›®å½•ï¼ŒE2E æµ‹è¯•ç‹¬ç«‹ |
| **é…ç½®é›†ä¸­ç®¡ç†** | ç¯å¢ƒå˜é‡ã€å¸¸é‡ç»Ÿä¸€æ”¾åœ¨ constants/ |

### 5.2 å…³é”®ç›®å½•è¯´æ˜

| ç›®å½• | æŠ€æœ¯æ ˆ | éƒ¨ç½²ç›®æ ‡ |
| ---- | ------ | -------- |
| `apps/web` | Next.js 14 | Vercel |
| `apps/api` | Node.js Serverless | Vercel Functions |
| `runtime` | Python + LangGraph | Modal / Fly.io |
| `database/migrations` | SQL | Supabase |

## 6. æ‰©å±•æ€§è®¾è®¡

### 6.1 æ°´å¹³æ‰©å±•

- **API å±‚**: Vercel è‡ªåŠ¨æ‰©ç¼©å®¹
- **Worker å±‚**: Modal/Fly.io æŒ‰éœ€å¯åŠ¨å®¹å™¨
- **æ•°æ®å±‚**: Supabase/Upstash æ‰˜ç®¡æœåŠ¡è‡ªåŠ¨æ‰©å±•

### 6.2 æ’ä»¶åŒ–æ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Plugin System            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Skills  â”‚  â”‚    Tools      â”‚   â”‚
â”‚  â”‚  Plugins  â”‚  â”‚   Plugins     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    LLM    â”‚  â”‚   Memory      â”‚   â”‚
â”‚  â”‚ Providers â”‚  â”‚   Backends    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. é”™è¯¯å¤„ç†æ¶æ„

### 7.1 é”™è¯¯åˆ†ç±»ä¸å¤„ç†ç­–ç•¥

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           é”™è¯¯å¤„ç†æ¶æ„                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        é”™è¯¯åˆ†ç±»                                       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚ å¯æ¢å¤é”™è¯¯  â”‚  â”‚ ä¸å¯æ¢å¤é”™è¯¯â”‚  â”‚  è¶…æ—¶é”™è¯¯   â”‚  â”‚  é™æµé”™è¯¯   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚ Retryable  â”‚  â”‚   Fatal    â”‚  â”‚  Timeout   â”‚  â”‚ RateLimit  â”‚     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚   â”‚
â”‚  â”‚  â”‚ ç½‘ç»œæŠ–åŠ¨   â”‚  â”‚ è®¤è¯å¤±è´¥   â”‚  â”‚ LLM è¶…æ—¶   â”‚  â”‚ API é™æµ   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚ ä¸´æ—¶æœåŠ¡   â”‚  â”‚ æƒé™ä¸è¶³   â”‚  â”‚ Tool è¶…æ—¶  â”‚  â”‚ Token é™åˆ¶  â”‚     â”‚   â”‚
â”‚  â”‚  â”‚ ä¸å¯ç”¨     â”‚  â”‚ æ•°æ®æ ¡éªŒ   â”‚  â”‚ SSE æ–­è¿   â”‚  â”‚            â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        å¤„ç†ç­–ç•¥                                       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Retryable  â†’ æŒ‡æ•°é€€é¿é‡è¯• (æœ€å¤š 3 æ¬¡, å»¶è¿Ÿ 1s/2s/4s)                  â”‚   â”‚
â”‚  â”‚  Fatal      â†’ ç«‹å³å¤±è´¥ï¼Œè¿”å›ç”¨æˆ·å¯ç†è§£çš„é”™è¯¯ä¿¡æ¯                       â”‚   â”‚
â”‚  â”‚  Timeout    â†’ å–æ¶ˆå½“å‰æ“ä½œï¼Œè§¦å‘é™çº§é€»è¾‘                               â”‚   â”‚
â”‚  â”‚  RateLimit  â†’ æ’é˜Ÿç­‰å¾…æˆ–è¿”å› 429ï¼Œæç¤ºç”¨æˆ·ç¨åé‡è¯•                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å‰ç«¯é”™è¯¯è¾¹ç•Œ

```typescript
// components/ErrorBoundary.tsx
interface ErrorBoundaryState {
  hasError: boolean
  error: Error | null
  errorInfo: React.ErrorInfo | null
}

// é”™è¯¯è¾¹ç•Œå±‚çº§
const errorBoundaryLayers = {
  app: 'AppErrorBoundary',        // åº”ç”¨çº§ - æ˜¾ç¤ºå…¨å±€é”™è¯¯é¡µ
  route: 'RouteErrorBoundary',    // è·¯ç”±çº§ - æ˜¾ç¤ºé¡µé¢é”™è¯¯
  component: 'ComponentBoundary', // ç»„ä»¶çº§ - æ˜¾ç¤ºç»„ä»¶å ä½ç¬¦
  chat: 'ChatErrorBoundary',      // å¯¹è¯çº§ - æ˜¾ç¤ºé‡è¯•æŒ‰é’®
}

// é”™è¯¯æ¢å¤ç­–ç•¥
interface ErrorRecoveryStrategy {
  canRetry: boolean              // æ˜¯å¦å¯é‡è¯•
  retryAction?: () => void       // é‡è¯•åŠ¨ä½œ
  fallbackUI?: React.ReactNode   // é™çº§ UI
  reportError: boolean           // æ˜¯å¦ä¸ŠæŠ¥
}
```

### 7.3 SSE æ–­çº¿é‡è¿æœºåˆ¶

```typescript
// hooks/useSSE.ts
interface SSEConfig {
  url: string
  maxRetries: number              // æœ€å¤§é‡è¯•æ¬¡æ•°: 5
  baseDelay: number               // åŸºç¡€å»¶è¿Ÿ: 1000ms
  maxDelay: number                // æœ€å¤§å»¶è¿Ÿ: 30000ms
  heartbeatInterval: number       // å¿ƒè·³é—´éš”: 30000ms
}

// é‡è¿çŠ¶æ€æœº
type SSEState =
  | 'connecting'    // è¿æ¥ä¸­
  | 'connected'     // å·²è¿æ¥
  | 'reconnecting'  // é‡è¿ä¸­
  | 'disconnected'  // å·²æ–­å¼€
  | 'failed'        // é‡è¿å¤±è´¥

// æ–­çº¿é‡è¿æµç¨‹
// 1. æ£€æµ‹æ–­çº¿ (onerror / å¿ƒè·³è¶…æ—¶)
// 2. è¿›å…¥ reconnecting çŠ¶æ€
// 3. æŒ‡æ•°é€€é¿: delay = min(baseDelay * 2^attempt, maxDelay)
// 4. é‡è¿æˆåŠŸ â†’ connected, å¤±è´¥ â†’ é‡è¯•ç›´åˆ° maxRetries
// 5. è¶…è¿‡é‡è¯•æ¬¡æ•° â†’ failed, æç¤ºç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°
```

### 7.4 Agent æ‰§è¡Œé”™è¯¯å¤„ç†

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agent æ‰§è¡Œé”™è¯¯å¤„ç†æµç¨‹                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   START â†’ THINK â†’ ACT â†’ [ERROR?]                                â”‚
â”‚                           â”‚                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â–¼            â–¼            â–¼                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚ Tool   â”‚  â”‚  LLM   â”‚  â”‚ System â”‚                     â”‚
â”‚         â”‚ Error  â”‚  â”‚ Error  â”‚  â”‚ Error  â”‚                     â”‚
â”‚         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                     â”‚
â”‚             â”‚           â”‚           â”‚                           â”‚
â”‚             â–¼           â–¼           â–¼                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚ é‡è¯•   â”‚  â”‚ é™çº§   â”‚  â”‚ å›æ»š   â”‚                     â”‚
â”‚         â”‚ Tool   â”‚  â”‚ æ¨¡å‹   â”‚  â”‚ çŠ¶æ€   â”‚                     â”‚
â”‚         â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                     â”‚
â”‚             â”‚           â”‚           â”‚                           â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚                   [ä»å¤±è´¥?] â”€â”€â”€ Yes â”€â”€â†’ FAILED (é€šçŸ¥ç”¨æˆ·)        â”‚
â”‚                         â”‚                                        â”‚
â”‚                        No                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚                   ç»§ç»­æ‰§è¡Œæµç¨‹                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.5 é”™è¯¯ä¸ŠæŠ¥ä¸ç›‘æ§

| é”™è¯¯ç±»å‹ | ä¸ŠæŠ¥æ¸ é“ | å‘Šè­¦çº§åˆ« | å¤„ç† SLA |
| -------- | -------- | -------- | -------- |
| API 5xx | Sentry + PagerDuty | P1 Critical | 15 åˆ†é’Ÿå“åº” |
| LLM è°ƒç”¨å¤±è´¥ç‡ > 5% | Prometheus Alert | P2 High | 30 åˆ†é’Ÿå“åº” |
| SSE æ–­è¿ç‡ > 10% | Grafana Dashboard | P3 Medium | 2 å°æ—¶å“åº” |
| å‰ç«¯ JS é”™è¯¯ | Sentry | P4 Low | 24 å°æ—¶å“åº” |

## 8. æ€§èƒ½æŒ‡æ ‡ä¸ SLA

### 8.1 æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ç±»åˆ« | æŒ‡æ ‡åç§° | ç›®æ ‡å€¼ | å‘Šè­¦é˜ˆå€¼ |
| -------- | -------- | ------ | -------- |
| **å»¶è¿Ÿ** | API å“åº”æ—¶é—´ (P50) | < 100ms | > 200ms |
| | API å“åº”æ—¶é—´ (P99) | < 500ms | > 1s |
| | SSE é¦–å­—èŠ‚å»¶è¿Ÿ | < 200ms | > 500ms |
| | SSE æ¶ˆæ¯é—´éš” | < 100ms | > 300ms |
| **åå** | API QPS (å•å®ä¾‹) | 1000 req/s | > 800 req/s |
| | å¹¶å‘ SSE è¿æ¥æ•° | 10,000 | > 8,000 |
| | å¹¶å‘ Agent æ‰§è¡Œæ•° | 500 | > 400 |
| **å¯ç”¨æ€§** | API å¯ç”¨æ€§ | 99.9% | < 99.5% |
| | Agent æ‰§è¡ŒæˆåŠŸç‡ | 95% | < 90% |
| **èµ„æº** | Worker å†…å­˜ä½¿ç”¨ | < 512MB | > 400MB |
| | Worker CPU ä½¿ç”¨ç‡ | < 70% | > 80% |

### 8.2 Agent æ‰§è¡Œè¶…æ—¶é…ç½®

| æ“ä½œç±»å‹ | è¶…æ—¶æ—¶é—´ | é‡è¯•æ¬¡æ•° | é‡è¯•ç­–ç•¥ |
| -------- | -------- | -------- | -------- |
| LLM è°ƒç”¨ (ç®€å•) | 30s | 3 | æŒ‡æ•°é€€é¿ |
| LLM è°ƒç”¨ (å¤æ‚æ¨ç†) | 120s | 2 | æŒ‡æ•°é€€é¿ |
| Tool: web_search | 15s | 2 | ç«‹å³é‡è¯• |
| Tool: code_executor | 60s | 1 | æ— é‡è¯• |
| Tool: browser_control | 30s | 2 | æŒ‡æ•°é€€é¿ |
| å•æ­¥éª¤æ€»è¶…æ—¶ | 180s | - | å¼ºåˆ¶ç»ˆæ­¢ |
| æ•´ä½“ä¼šè¯è¶…æ—¶ | 600s | - | å¼ºåˆ¶ç»ˆæ­¢ |

### 8.3 é™æµé…ç½®

| èµ„æºç±»å‹ | é™åˆ¶ç»´åº¦ | é™åˆ¶å€¼ | è¶…é™å¤„ç† |
| -------- | -------- | ------ | -------- |
| API è¯·æ±‚ | ç”¨æˆ·/åˆ†é’Ÿ | 60 | 429 + Retry-After |
| API è¯·æ±‚ | ç»„ç»‡/åˆ†é’Ÿ | 600 | 429 + Retry-After |
| SSE è¿æ¥ | ç”¨æˆ· | 5 | æ‹’ç»æ–°è¿æ¥ |
| Agent å¹¶å‘ | ç”¨æˆ· | 3 | æ’é˜Ÿç­‰å¾… |
| Agent å¹¶å‘ | ç»„ç»‡ | 20 | æ’é˜Ÿç­‰å¾… |
| LLM Token | ç”¨æˆ·/å¤© | 100,000 | æç¤ºå‡çº§ |
| LLM Token | ç»„ç»‡/å¤© | 1,000,000 | æç¤ºå‡çº§ |

### 8.4 SLA å®šä¹‰

| æœåŠ¡ç­‰çº§ | å¯ç”¨æ€§ç›®æ ‡ | æœˆåº¦å…è®¸åœæœº | å“åº”æ—¶é—´æ‰¿è¯º |
| -------- | ---------- | ------------ | ------------ |
| **Free** | 99% | 7.3 å°æ—¶ | å°½åŠ›è€Œä¸º |
| **Pro** | 99.5% | 3.6 å°æ—¶ | < 500ms P99 |
| **Enterprise** | 99.9% | 43 åˆ†é’Ÿ | < 200ms P99 |

**SLA æ’é™¤é¡¹**ï¼š
- è®¡åˆ’å†…ç»´æŠ¤çª—å£ (æå‰ 72 å°æ—¶é€šçŸ¥)
- ç¬¬ä¸‰æ–¹ LLM æä¾›å•†æ•…éšœ
- ä¸å¯æŠ—åŠ›å› ç´ 

## 9. å®‰å…¨è®¾è®¡

### 9.1 è®¤è¯æˆæƒ

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       è®¤è¯æˆæƒæ¶æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   API Key è®¤è¯   â”‚    â”‚   JWT è®¤è¯       â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
â”‚  â”‚ é€‚ç”¨: æœåŠ¡é—´è°ƒç”¨ â”‚    â”‚ é€‚ç”¨: ç”¨æˆ·ä¼šè¯   â”‚                    â”‚
â”‚  â”‚ æ ¼å¼: sk-xxx    â”‚    â”‚ æœ‰æ•ˆæœŸ: 24h      â”‚                    â”‚
â”‚  â”‚ å­˜å‚¨: å“ˆå¸Œå­˜å‚¨   â”‚    â”‚ åˆ·æ–°: refresh_tk â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    RBAC æƒé™æ¨¡å‹                          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  è§’è‰²        â”‚ æƒé™                                      â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  owner       â”‚ ç»„ç»‡ç®¡ç†ã€æˆå‘˜ç®¡ç†ã€æ‰€æœ‰èµ„æº CRUD           â”‚   â”‚
â”‚  â”‚  admin       â”‚ æˆå‘˜ç®¡ç†ã€æ‰€æœ‰èµ„æº CRUD                    â”‚   â”‚
â”‚  â”‚  member      â”‚ èµ„æº CRUD (ä»…è‡ªå·±åˆ›å»ºçš„)                   â”‚   â”‚
â”‚  â”‚  viewer      â”‚ èµ„æºåªè¯»                                   â”‚   â”‚
â”‚  â”‚  api_service â”‚ ä»… API è°ƒç”¨ï¼Œæ—  UI è®¿é—®                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 API Key å®‰å…¨ç®¡ç†

| å®‰å…¨æªæ–½ | å®ç°æ–¹å¼ | è¯´æ˜ |
| -------- | -------- | ---- |
| **ç”Ÿæˆ** | crypto.randomBytes(32) | 256-bit éšæœºå¯†é’¥ |
| **å­˜å‚¨** | bcrypt å“ˆå¸Œ (cost=12) | ä»…å­˜å‚¨å“ˆå¸Œå€¼ï¼ŒåŸæ–‡ä¸å¯é€† |
| **æ˜¾ç¤º** | ä»…åˆ›å»ºæ—¶æ˜¾ç¤ºä¸€æ¬¡ | åˆ›å»ºåä»…æ˜¾ç¤ºå‰ç¼€ `sk-...xxxx` |
| **è½®æ¢** | æ”¯æŒæ‰‹åŠ¨è½®æ¢ | ä¿ç•™æ—§ Key 24h è¿‡æ¸¡æœŸ |
| **åŠé”€** | ç«‹å³ç”Ÿæ•ˆ | å†™å…¥ Redis é»‘åå•ï¼ŒTTL=24h |
| **æƒé™** | ç»†ç²’åº¦ Scope | `agents:read`, `sessions:write` ç­‰ |
| **å®¡è®¡** | è®°å½•æ‰€æœ‰ä½¿ç”¨ | IPã€æ—¶é—´ã€è°ƒç”¨ç«¯ç‚¹ |

### 9.3 æ•°æ®å®‰å…¨

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ•°æ®å®‰å…¨ç­–ç•¥                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ä¼ è¾“å®‰å…¨                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ HTTPS å¼ºåˆ¶ (HSTS, TLS 1.3)                            â”‚   â”‚
â”‚  â”‚  â€¢ WebSocket ä½¿ç”¨ wss://                                  â”‚   â”‚
â”‚  â”‚  â€¢ å†…éƒ¨æœåŠ¡é€šä¿¡: mTLS                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å­˜å‚¨å®‰å…¨                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  æ•æ„Ÿå­—æ®µ        â”‚ åŠ å¯†æ–¹å¼                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  api_key_hash    â”‚ bcrypt (ä¸å¯é€†)                        â”‚   â”‚
â”‚  â”‚  user_password   â”‚ Argon2id (ä¸å¯é€†)                      â”‚   â”‚
â”‚  â”‚  llm_api_keys    â”‚ AES-256-GCM (å¯é€†, ç”¨äºè°ƒç”¨)           â”‚   â”‚
â”‚  â”‚  message_content â”‚ æ˜æ–‡ (å¯é€‰ E2E åŠ å¯†)                    â”‚   â”‚
â”‚  â”‚  execution_logs  â”‚ æ˜æ–‡ (è„±æ•å¤„ç†)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å¯†é’¥ç®¡ç†                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ ä¸»å¯†é’¥å­˜å‚¨: ç¯å¢ƒå˜é‡ / Vault                           â”‚   â”‚
â”‚  â”‚  â€¢ å¯†é’¥è½®æ¢: æ¯ 90 å¤©è‡ªåŠ¨è½®æ¢                              â”‚   â”‚
â”‚  â”‚  â€¢ å¤‡ä»½å¯†é’¥: ç‹¬ç«‹å­˜å‚¨ï¼ŒåŒäººæˆæƒè®¿é—®                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.4 ä»£ç æ‰§è¡Œæ²™ç®±

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»£ç æ‰§è¡Œæ²™ç®±æ¶æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    éš”ç¦»å±‚çº§                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Layer 1: å®¹å™¨éš”ç¦» (Docker / gVisor)                      â”‚   â”‚
â”‚  â”‚  Layer 2: ç½‘ç»œéš”ç¦» (æ— å¤–ç½‘ / ä»…ç™½åå•)                     â”‚   â”‚
â”‚  â”‚  Layer 3: æ–‡ä»¶ç³»ç»Ÿéš”ç¦» (åªè¯»æ ¹ + ä¸´æ—¶å†™å…¥ç›®å½•)             â”‚   â”‚
â”‚  â”‚  Layer 4: èµ„æºé™åˆ¶ (cgroups)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    èµ„æºé…é¢                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  èµ„æº        â”‚ é™åˆ¶å€¼                                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  CPU         â”‚ 1 core                                    â”‚   â”‚
â”‚  â”‚  å†…å­˜        â”‚ 256MB                                     â”‚   â”‚
â”‚  â”‚  æ‰§è¡Œæ—¶é—´    â”‚ 60s                                       â”‚   â”‚
â”‚  â”‚  ç£ç›˜å†™å…¥    â”‚ 100MB                                     â”‚   â”‚
â”‚  â”‚  è¿›ç¨‹æ•°      â”‚ 50                                        â”‚   â”‚
â”‚  â”‚  ç½‘ç»œ        â”‚ ç¦ç”¨ / ä»…æŒ‡å®š API                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å®‰å…¨ç­–ç•¥                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ ç¦æ­¢ç³»ç»Ÿè°ƒç”¨: fork, exec, ptrace                       â”‚   â”‚
â”‚  â”‚  â€¢ ç¦æ­¢æ–‡ä»¶æ“ä½œ: /etc, /proc, /sys                        â”‚   â”‚
â”‚  â”‚  â€¢ ä»£ç å®¡æŸ¥: é™æ€åˆ†ææ£€æµ‹å±é™©æ¨¡å¼                          â”‚   â”‚
â”‚  â”‚  â€¢ è¾“å‡ºè¿‡æ»¤: æ•æ„Ÿä¿¡æ¯è„±æ• (API Key, Token)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.5 å®‰å…¨å®¡è®¡æ—¥å¿—

```typescript
// å®¡è®¡æ—¥å¿—è®°å½•å†…å®¹
interface AuditLog {
  timestamp: string
  eventType: AuditEventType
  actor: {
    userId: string
    orgId: string
    ipAddress: string
    userAgent: string
  }
  resource: {
    type: 'agent' | 'session' | 'apiKey' | 'org' | 'user'
    id: string
    action: 'create' | 'read' | 'update' | 'delete' | 'execute'
  }
  result: 'success' | 'failure'
  details?: Record<string, unknown>
}

type AuditEventType =
  | 'auth.login'
  | 'auth.logout'
  | 'auth.failed'
  | 'apiKey.created'
  | 'apiKey.revoked'
  | 'agent.executed'
  | 'data.exported'
  | 'permission.changed'
```

### 9.6 å®‰å…¨æ£€æŸ¥æ¸…å•

| æ£€æŸ¥é¡¹ | é¢‘ç‡ | è´£ä»»æ–¹ |
| ------ | ---- | ------ |
| ä¾èµ–æ¼æ´æ‰«æ (npm audit / safety) | æ¯æ¬¡ CI | è‡ªåŠ¨åŒ– |
| SAST é™æ€ä»£ç åˆ†æ | æ¯æ¬¡ PR | è‡ªåŠ¨åŒ– |
| æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æµ‹ (git-secrets) | æ¯æ¬¡æäº¤ | è‡ªåŠ¨åŒ– |
| API æ¸—é€æµ‹è¯• | æ¯å­£åº¦ | å®‰å…¨å›¢é˜Ÿ |
| æƒé™é…ç½®å®¡è®¡ | æ¯æœˆ | è¿ç»´å›¢é˜Ÿ |
| å¯†é’¥è½®æ¢æ£€æŸ¥ | æ¯æœˆ | è¿ç»´å›¢é˜Ÿ |
