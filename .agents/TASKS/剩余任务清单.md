# 任务批量创建清单

以下是剩余需要创建的任务文件清单。每个任务都有明确的优先级、类型和预估工时。

---

## 🟡 P1 - 高优先级（剩余 11 个）

### 15. 数据库规范 - 实现乐观锁版本检查
- **文件**: `15-数据库规范-乐观锁实现.md`
- **预估工时**: 2-3h
- **问题**: 更新时未检查版本冲突
- **影响**: 并发更新可能导致数据覆盖

### 16. 并发规范 - MCP 资源清理
- **文件**: `16-���发规范-MCP资源清理.md`
- **预估工时**: 1-2h
- **问题**: close_all 方法未清理内部字典
- **影响**: 可能导致内存泄漏

### 17. 代码质量 - 常量定义规范化
- **文件**: `17-代码质量-常量定义规范化.md`
- **预估工时**: 2-3h
- **问题**: 服务层存在局部常量定义
- **影响**: 配置不统一，难以维护

### 18. 代码质量 - 优化 N+1 查询
- **文件**: `18-代码质量-优化N+1查询.md`
- **预估工时**: 2-3h
- **问题**: getActiveSkillsByIds 使用循环查询
- **影响**: 性能问题

### 19. 代码质量 - 统一 Repository 实现
- **文件**: `19-代码质量-统一Repository实现.md`
- **预估工时**: 2-3h
- **问题**: agent.repository.ts 的 update 方法过于复杂
- **影响**: 代码难以维护

### 20. 测试覆盖 - MCP 模块测试
- **文件**: `20-测试覆盖-MCP模块测试.md`
- **预估工时**: 2-3天
- **问题**: MCP 模块完全缺失测试
- **影响**: 外部集成风险高

### 21. 测试覆盖 - Middleware 测试
- **文件**: `21-测试覆盖-Middleware测试.md`
- **预估工时**: 2-3天
- **问题**: auth、errorHandler、rateLimit 无测试
- **影响**: 安全和稳定性风险

### 22. 测试覆盖 - 前端页面测试
- **文件**: `22-测试覆盖-前端页面测试.md`
- **预估工时**: 4-5天
- **问题**: 19 个页面组件完全缺失测试
- **影响**: 用户界面回归风险高

### 23. 文档完整 - 子模块 README
- **文件**: `23-文档完整-子模块README.md`
- **预估工时**: 2-3h
- **问题**: apps/web、apps/api、packages/* 无 README
- **影响**: 模块说明缺失

### 24. 文档完整 - 贡献指南
- **文件**: `24-文档完整-贡献指南.md`
- **预估工时**: 1-2h
- **问题**: 缺少 CONTRIBUTING.md
- **影响**: 贡献流程不清晰

### 25. 文档完整 - OpenAPI 规范
- **文件**: `25-文档完整-OpenAPI规范.md`
- **预估工时**: 2-3h
- **问题**: 缺少 openapi.yaml
- **影响**: API 文档不可交互

---

## 🟢 P2 - 中优先级（10 个）

### 26. 编码规范 - 错误处理统一
- **文件**: `26-编码规范-错误处理统一.md`
- **预估工时**: 1-2h
- **问题**: auth.service.ts 直接抛对象
- **影响**: 错误处理不一致

### 27. 安全规范 - Tool/Skill org_id 验证
- **文件**: `27-安全规范-Tool-Skill-org_id验证.md`
- **预估工时**: 2-3h
- **问题**: Service 层需要验证自定义资源的 org_id
- **影响**: 中等安全风险

### 28. 代码质量 - 类型定义去重
- **文件**: `28-代码质量-类型定义去重.md`
- **预估工时**: 1-2h
- **问题**: PaginatedResult 类型重复定义
- **影响**: 代码重复

### 29. 代码质量 - Executor 职责明确
- **文件**: `29-代码质量-Executor职责明确.md`
- **预估工时**: 2-3h
- **问题**: ActionExecutor vs UnifiedActionExecutor 职责重叠
- **影响**: 架构不清晰

### 30. 测试覆盖 - LLM Provider 测试
- **文件**: `30-测试覆盖-LLM-Provider测试.md`
- **预估工时**: 2-3天
- **问题**: 5 个 LLM Provider 无测试
- **影响**: 核心功能风险

### 31. 测试覆盖 - 前端业务组件测试
- **文件**: `31-测试覆盖-前端业务组件测试.md`
- **预估工时**: 3-4天
- **问题**: 约 30 个业务组件无测试
- **影响**: UI 回归风险

### 32. 测试覆盖 - 未测试 Services
- **文件**: `32-测试覆盖-未测试Services.md`
- **预估工时**: 2-3天
- **问题**: 8 个 Service 无测试
- **影响**: 业务逻辑风险

### 33. 文档完整 - 部署文档完善
- **文件**: `33-文档完整-部署文档完善.md`
- **预估工时**: 2-3h
- **问题**: 缺少部署检查清单、灾难恢复计划
- **影响**: 生产部署风险

### 34. 文档完整 - 示例代码
- **文件**: `34-文档完整-示例代码.md`
- **预估工时**: 3-4h
- **问题**: 缺少完整的使用示例
- **影响**: 上手门槛高

### 35. 文档完整 - CHANGELOG
- **文件**: `35-文档完整-CHANGELOG.md`
- **预估工时**: 1-2h
- **问题**: 缺少版本变更日志
- **影响**: 版本追踪困难

---

## 特殊任务

### 07. 代码质量 - 清理调试代码
- **文件**: `07-代码质量-清理调试代码.md`
- **预估工时**: 1-2h
- **问题**: agent.repository.ts 存在 9 处调试日志
- **影响**: 代码可读性和性能

### 08. 测试覆盖 - Sandbox 模块测试
- **文件**: `08-测试覆盖-Sandbox模块测试.md`
- **预估工时**: 3-5天
- **问题**: 安全关键模块完全缺失测试
- **影响**: 严重安全风险

### 09. 测试覆盖 - Repository 层测试
- **文件**: `09-测试覆盖-Repository层测试.md`
- **预估工时**: 3-4天
- **问题**: 12 个 Repository 完全缺失测试
- **影响**: 数据库操作和多租户隔离无保障

---

## 创建说明

每个任务文件应包含以下部分：

1. **任务头部**
   - 优先级
   - 类型
   - 预估工时
   - 影响范围

2. **问题描述**
   - 详细说明问题
   - 违规代码示例

3. **规范要求**
   - 引用相关规范
   - 正确示例

4. **修复方案**
   - 详细的修复步骤
   - 完整的代码示例

5. **测试验证**
   - 单元测试
   - 集成测试

6. **修复清单**
   - 具体的待办事项

7. **完成标准**
   - 明确的验收标准

8. **相关文档**
   - 规范文档链接
   - 相关任务链接

---

## 使用建议

由于任务数量较多，建议：

1. **优先处理 P0 严重问题**（已创建 7 个）
2. **按周计划处理 P1 高优先级**
3. **逐步改进 P2 中优先级**
4. **定期更新任务状态**

所有任务的详细模板和示例可参考已创建的任务文件：
- `01-编码规范-统一日志使用.md`
- `02-编码规范-消除硬编码.md`
- `03-安全规范-多租户隔离修复.md`
- 等等

---

**最后更新**: 2026-02-09
