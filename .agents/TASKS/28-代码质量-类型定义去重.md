# ä»»åŠ¡ï¼šç±»å‹å®šä¹‰å»é‡

**ä¼˜å…ˆçº§**: ğŸŸ¢ P2 - ä¸­ä¼˜å…ˆçº§
**ç±»å‹**: ä»£ç è´¨é‡
**é¢„ä¼°å·¥æ—¶**: 2-3 å°æ—¶
**å½±å“èŒƒå›´**: å¤šä¸ªæ–‡ä»¶

---

## é—®é¢˜æè¿°

ç±»å‹å®šä¹‰å­˜åœ¨é‡å¤ï¼ŒåŒä¸€ç±»å‹åœ¨å¤šå¤„å®šä¹‰ï¼Œå¯¼è‡´ï¼š
1. ä¿®æ”¹æ—¶å®¹æ˜“é—æ¼
2. ç±»å‹ä¸ä¸€è‡´é£é™©
3. ç»´æŠ¤æˆæœ¬é«˜

---

## é‡å¤ä½ç½®ç¤ºä¾‹

### Agent ç±»å‹

```typescript
// apps/api/src/types/agent.ts
interface Agent {
  id: string
  name: string
  description?: string
  // ...
}

// packages/shared-types/src/entities/agent.ts
interface Agent {
  id: string
  name: string
  description?: string
  // ...
}

// apps/web/lib/types.ts
interface Agent {
  id: string
  name: string
  // ... å¯èƒ½ç¼ºå°‘æŸäº›å­—æ®µ
}
```

### Session ç±»å‹

```typescript
// apps/api/src/types/session.ts
interface Session { ... }

// packages/shared-types/src/entities/session.ts
interface Session { ... }
```

---

## ä¿®å¤æ–¹æ¡ˆ

### 1. ç»Ÿä¸€ç±»å‹å®šä¹‰ä½ç½®

æ‰€æœ‰ç±»å‹å®šä¹‰ç»Ÿä¸€æ”¾åœ¨ `packages/shared-types` ä¸­ï¼š

```
packages/shared-types/src/
â”œâ”€â”€ entities/           # å®ä½“ç±»å‹
â”‚   â”œâ”€â”€ agent.ts
â”‚   â”œâ”€â”€ session.ts
â”‚   â”œâ”€â”€ message.ts
â”‚   â”œâ”€â”€ skill.ts
â”‚   â”œâ”€â”€ tool.ts
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ dto/                # DTO ç±»å‹
â”‚   â”œâ”€â”€ agent.dto.ts
â”‚   â”œâ”€â”€ session.dto.ts
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ api/                # API ç›¸å…³ç±»å‹
â”‚   â”œâ”€â”€ request.ts
â”‚   â”œâ”€â”€ response.ts
â”‚   â””â”€â”€ index.ts
â””â”€â”€ index.ts            # ç»Ÿä¸€å¯¼å‡º
```

### 2. å®ä½“ç±»å‹å®šä¹‰

```typescript
// packages/shared-types/src/entities/agent.ts

/**
 * Agent å®ä½“ç±»å‹
 */
export interface Agent {
  /** Agent ID */
  id: string
  /** ç»„ç»‡ ID */
  orgId: string
  /** Agent åç§° */
  name: string
  /** Agent æè¿° */
  description?: string
  /** ç³»ç»Ÿæç¤ºè¯ */
  systemPrompt?: string
  /** æ¨¡å‹é…ç½® */
  modelConfig?: AgentModelConfig
  /** æ˜¯å¦æ¿€æ´» */
  isActive: boolean
  /** æ˜¯å¦å…¬å¼€ */
  isPublic: boolean
  /** ç‰ˆæœ¬å· */
  version: number
  /** åˆ›å»ºæ—¶é—´ */
  createdAt: string
  /** åˆ›å»ºäºº ID */
  createdBy: string
  /** æ›´æ–°æ—¶é—´ */
  updatedAt: string
  /** æ›´æ–°äºº ID */
  updatedBy?: string
}

/**
 * Agent æ¨¡å‹é…ç½®
 */
export interface AgentModelConfig {
  /** æ¨¡å‹æä¾›å•† */
  provider: 'openai' | 'anthropic' | 'azure'
  /** æ¨¡å‹åç§° */
  model: string
  /** æ¸©åº¦å‚æ•° */
  temperature?: number
  /** æœ€å¤§ Token æ•° */
  maxTokens?: number
}
```

### 3. DTO ç±»å‹å®šä¹‰

```typescript
// packages/shared-types/src/dto/agent.dto.ts

import { Agent, AgentModelConfig } from '../entities/agent'

/**
 * åˆ›å»º Agent è¾“å…¥
 */
export interface CreateAgentInput {
  name: string
  description?: string
  systemPrompt?: string
  modelConfig?: AgentModelConfig
  isActive?: boolean
  isPublic?: boolean
}

/**
 * æ›´æ–° Agent è¾“å…¥
 */
export interface UpdateAgentInput {
  name?: string
  description?: string
  systemPrompt?: string
  modelConfig?: AgentModelConfig
  isActive?: boolean
  isPublic?: boolean
  /** ä¹è§‚é”ç‰ˆæœ¬å· */
  version: number
}

/**
 * Agent åˆ—è¡¨æŸ¥è¯¢å‚æ•°
 */
export interface ListAgentsParams {
  page?: number
  limit?: number
  search?: string
  isActive?: boolean
}

/**
 * Agent å“åº”ç±»å‹ï¼ˆç­‰åŒäº Agentï¼‰
 */
export type AgentResponse = Agent
```

### 4. ç»Ÿä¸€å¯¼å‡º

```typescript
// packages/shared-types/src/index.ts

// å®ä½“ç±»å‹
export * from './entities/agent'
export * from './entities/session'
export * from './entities/message'
export * from './entities/skill'
export * from './entities/tool'

// DTO ç±»å‹
export * from './dto/agent.dto'
export * from './dto/session.dto'
export * from './dto/auth.dto'

// API ç±»å‹
export * from './api/response'
export * from './api/pagination'
```

### 5. åœ¨å„æ¨¡å—ä¸­ä½¿ç”¨

```typescript
// apps/api/src/services/agent.service.ts
import { Agent, CreateAgentInput, UpdateAgentInput } from '@semibot/shared-types'

// apps/web/lib/api/agents.ts
import { Agent, CreateAgentInput, ListAgentsParams } from '@semibot/shared-types'
```

---

## éœ€è¦æ£€æŸ¥çš„ç±»å‹

| ç±»å‹ | å½“å‰ä½ç½® | ç›®æ ‡ä½ç½® |
|------|----------|----------|
| Agent | api/types, web/lib | shared-types/entities |
| Session | api/types, web/lib | shared-types/entities |
| Message | api/types, web/lib | shared-types/entities |
| Skill | api/types, web/lib | shared-types/entities |
| Tool | api/types, web/lib | shared-types/entities |
| User | api/types, web/lib | shared-types/entities |
| CreateAgentInput | api/types | shared-types/dto |
| UpdateAgentInput | api/types | shared-types/dto |
| ApiResponse | api/types, web/lib | shared-types/api |
| PaginationMeta | api/types, web/lib | shared-types/api |

---

## ä¿®å¤æ¸…å•

### ç±»å‹æ•´ç†
- [ ] ç›˜ç‚¹æ‰€æœ‰é‡å¤ç±»å‹å®šä¹‰
- [ ] åˆå¹¶åˆ° `shared-types` åŒ…

### å®ä½“ç±»å‹
- [ ] `shared-types/entities/agent.ts`
- [ ] `shared-types/entities/session.ts`
- [ ] `shared-types/entities/message.ts`
- [ ] `shared-types/entities/skill.ts`
- [ ] `shared-types/entities/tool.ts`
- [ ] `shared-types/entities/user.ts`

### DTO ç±»å‹
- [ ] `shared-types/dto/agent.dto.ts`
- [ ] `shared-types/dto/session.dto.ts`
- [ ] `shared-types/dto/auth.dto.ts`

### æ›´æ–°å¼•ç”¨
- [ ] æ›´æ–° `apps/api` ä¸­çš„å¼•ç”¨
- [ ] æ›´æ–° `apps/web` ä¸­çš„å¼•ç”¨
- [ ] åˆ é™¤é‡å¤çš„ç±»å‹æ–‡ä»¶

---

## å®Œæˆæ ‡å‡†

- [ ] æ‰€æœ‰ç±»å‹å®šä¹‰å”¯ä¸€
- [ ] ç±»å‹å®šä¹‰é›†ä¸­åœ¨ `shared-types`
- [ ] æ‰€æœ‰æ¨¡å—ä½¿ç”¨ç»Ÿä¸€çš„ç±»å‹
- [ ] TypeScript ç¼–è¯‘é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡

---

## ç›¸å…³æ–‡æ¡£

- [API è§„èŒƒ - ç±»å‹å®šä¹‰](.claude/rules/api-standards.md#ç±»å‹å®šä¹‰)
